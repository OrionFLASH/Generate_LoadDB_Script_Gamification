#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./activate_local.sh

echo "üöÄ –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
if [ ! -d "./local_env" ]; then
    echo "‚ùå –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞!"
    echo "üìã –°–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π:"
    echo "   conda create --prefix ./local_env python=3.9 --yes"
    echo "   conda activate ./local_env"
    echo "   pip install -r requirements.txt"
    exit 1
fi

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo "‚úÖ –ê–∫—Ç–∏–≤–∏—Ä—É—é –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ: $(pwd)/local_env"
conda activate ./local_env

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
if [ "$CONDA_PREFIX" = "$(pwd)/local_env" ]; then
    echo "‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ!"
    echo "üìÅ –ü—É—Ç—å: $CONDA_PREFIX"
    echo "üêç Python: $(which python)"
    echo ""
    echo "üéØ –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å:"
    echo "   python main.py"
    echo "   python json_parsers_runner.py all"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è"
    exit 1
fi 